"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[212],{68212:(e,n,t)=>{t.r(n),t.d(n,{default:()=>G});var a=t(54915),i=t(87273),s=t(95163),l=t(56386),o=t(94244);var r=t(97720);var d=t(40462);var c=t(47047);var u=t(3209),v=t(78765),h=t(25390),m=t(23439);const p=async()=>{var e;const n=null!==(e=(0,v.SC)())&&void 0!==e?e:await(0,m.In)(),t=await(0,h.p)(null===n||void 0===n?void 0:n.anchor,"nfid.one","0");return await v.It.getActivitiesByUser({identity:t})};var x=t(78693);var f=t(35826),g=t(36516);const y=async()=>{var e,n;const t=null!==(e=(0,v.SC)())&&void 0!==e?e:await(0,m.In)(),a=await(0,h.p)(null===t||void 0===t?void 0:t.anchor,"nfid.one","0"),i=await v.q_.getAddress(a),s=await v.q_.getFungibleActivityByTokenAndUser({direction:"to"},a),l=await v.q_.getFungibleActivityByTokenAndUser({direction:"from"},a);return null!==(n=s.activities.concat(l.activities).map((e=>({type:e.from===i.toLowerCase()?"send":"received",asset:"ETH",quantity:e.price,date:(0,u.Z)(new Date(e.date),"MMM dd, yyyy - hh:mm:ss aaa"),from:e.from,to:e.to}))))&&void 0!==n?n:[]},b=async()=>{var e;const n=null!==(e=(0,v.SC)())&&void 0!==e?e:await(0,m.In)(),t=await(0,h.p)(null===n||void 0===n?void 0:n.anchor,"nfid.one","0");return await v.q_.getActivitiesByUser({identity:t})},w=e=>n=>{let{transaction:t}=n;return{type:e,asset:t.operations[0].amount.currency.symbol,quantity:Math.abs(Number(t.operations[0].amount.value)),date:(0,u.Z)(new Date(t.metadata.timestamp/1e6),"MMM dd, yyyy - hh:mm:ss aaa"),from:t.operations[0].account.address,to:t.operations[1].account.address}},T=e=>{let{transactions:n,accounts:t}=e;return n.transactions.map(w("send")).filter((e=>t.indexOf(e.from)>-1))},j=e=>{let{transactions:n,accounts:t}=e;return n.transactions.map(w("received")).filter((e=>t.indexOf(e.to)>-1))};var Z=t(23210),N=t(72422),k=t(42809),M=t(69491),C=t(65794),P=t(20430);function F(e){return Array.isArray(e)?e.map((e=>F(e))):null!=e&&e.constructor===Object?Object.keys(e).reduce(((n,t)=>({...n,[(0,P.camelCase)(t)]:F(e[t])})),{}):e}async function E(e){return await e.json().then((e=>F(e))).then((e=>({totalCount:e.totalCount,transactions:e.transactions.map((e=>({blockIdentifier:e.blockIdentifier,transaction:{metadata:e.transaction.metadata,transactionIdentifier:e.transaction.transactionIdentifier,operations:e.transaction.operations.map((e=>({...e,amount:{currency:e.amount.currency,value:(Number(e.amount.value)/10**8).toString()}})))}})))})))}async function _(e){let n=(0,v.Qc)((0,a.PZ)(e));return await(0,v.L8)("POST",`${v.t$}/search/transactions`,n).then(E)}const I=()=>{const{principals:e}=(0,C.J)(),{data:n,isValidating:t}=(0,o.ZP)(e?[e.map((e=>{let{principal:n}=e;return n})),"allTransactions"]:null,(e=>{let[n]=e;return async function(e){return(e=>e.reduce(((e,n)=>{const t=e.transactions.map((e=>e.blockIdentifier.hash)),a=n.transactions.filter((e=>-1===t.indexOf(e.blockIdentifier.hash))).map((e=>e.blockIdentifier.hash));if(!a.length)return e;const i=n.transactions.filter((e=>-1!==a.indexOf(e.blockIdentifier.hash)));return{totalCount:e.totalCount+i.length,transactions:[...e.transactions,...i]}}),{totalCount:0,transactions:[]}))(await Promise.all(e.map(_)))}(n)}),{dedupingInterval:3e4,focusThrottleInterval:3e4});return console.debug("useAllTransactions",{transactions:n,isWalletTransactionsLoading:t}),{transactions:n,isWalletTransactionsLoading:t}};var B=t(58688),A=t(18414),O=t(82898);const S=t.p+"static/media/close.07f2bcc689da6dc4045266d9bafb5bd0.svg";var D=t(33693);const L=e=>{let{onRemove:n,title:t}=e;return null!==t&&void 0!==t&&t.length?(0,D.jsxs)("div",{className:(0,A.Z)("flex items-center space-x-1 pl-2 pr-0.5 py-0.5","border border-black rounded-full","w-max"),children:[(0,D.jsx)("span",{className:"text-xs tracking-[0.16px]",children:t}),(0,D.jsx)(O.Ee,{onClick:()=>n&&n(t),className:(0,A.Z)("block w-4 cursor-pointer","hover:bg-gray-200 rounded-full"),src:S,alt:""})]}):null};var R=t(80285),V=t(47200),$=t(72565);const q=[{name:"Sent",title:(0,D.jsx)(D.Fragment,{children:"Sent"})},{name:"Received",title:(0,D.jsx)(D.Fragment,{children:"Received"})}],U=e=>{let{sentData:n,receivedData:t,transactionsFilterOptions:a,setTransactionFilter:s,selectedTransactionFilter:l,onChipRemove:o,resetBlockchainFilter:r,blockchainFilter:d,blockchainOptions:c,setBlockchainFilter:u}=e;const[v,h]=(0,i.useState)("Sent"),[m,p]=(0,i.useState)([]);return(0,D.jsxs)($.Z,{pageTitle:"Transactions history",className:"w-full z-[1]",showBackButton:!0,children:[(0,D.jsx)(V.Z,{className:(0,A.Z)("bg-gray-200"),children:(0,D.jsxs)("div",{className:"flex items-center justify-between w-full space-x-10 ",children:[(0,D.jsx)(O.TV,{bordered:!1,options:a,placeholder:"All wallets",setSelectedValues:s,selectedValues:l.map((e=>e.value)),isSearch:!0}),(0,D.jsx)(O.EZ,{onReset:()=>r(),trigger:(0,D.jsx)(O.Z_,{className:"cursor-pointer"}),align:"end",children:(0,D.jsx)(O.TV,{label:"Blockchain",options:c.map((e=>({label:e,value:e}))),selectedValues:d,setSelectedValues:u})})]})}),(0,D.jsx)("div",{className:"mt-6 flex w-full flex-wrap gap-2.5",children:l.map((e=>(0,D.jsx)(L,{title:e.label,onRemove:o},e.label)))}),(0,D.jsx)(O.ne,{className:"mt-6",tabs:q,activeTab:v,setActiveTab:h}),(0,D.jsx)("div",{className:"w-full overflow-y-scroll",children:m.length?(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)("table",{className:(0,A.Z)("text-left w-full mb-16 sm:mb-0"),children:[(0,D.jsx)("thead",{className:(0,A.Z)("border-b border-black h-16"),children:(0,D.jsxs)("tr",{className:(0,A.Z)("font-bold text-sm leading-5"),children:[(0,D.jsx)("th",{className:"pl-4 w-[285px]",children:"Date"}),(0,D.jsx)("th",{className:"w-[95px]",children:"Asset"}),(0,D.jsx)("th",{className:"w-[160px]",children:"Quantity"}),(0,D.jsx)("th",{className:"min-w-[235px] pr-5",children:"From"}),(0,D.jsx)("th",{className:"min-w-[235px]",children:"To"})]})}),(0,D.jsx)("tbody",{className:(0,A.Z)("text-sm text-[#0B0E13] border-b"),children:m.map(((e,n)=>(0,D.jsxs)("tr",{className:(0,A.Z)("hover:bg-[#F3F4F6] hover:cursor-pointer h-16"),id:`transaction_${n}`,children:[(0,D.jsx)("td",{className:"pl-4 whitespace-nowrap",id:`transaction_date_${n}`,children:e.date}),(0,D.jsx)("td",{id:`transaction_asset_${n}`,children:e.asset}),(0,D.jsx)("td",{id:`transaction_quantity_${n}`,children:e.quantity}),(0,D.jsx)("td",{children:(0,D.jsx)("span",{className:(0,A.Z)("inline-block max-w-[400px] break-words pr-5"),id:`transaction_from_${n}`,children:e.from})}),(0,D.jsx)("td",{children:(0,D.jsx)("span",{className:(0,A.Z)("inline-block max-w-[400px] break-words"),id:`transaction_to_${n}`,children:e.to})})]},`transaction_${n}_${e.date}}`)))})]})}):(0,D.jsx)("div",{className:(0,A.Z)("w-full h-[50vh]","flex justify-center items-center flex-col"),children:(0,D.jsx)("p",{className:"mb-4 text-sm text-center",children:"No recent transactions to display."})})}),(0,D.jsx)("div",{className:(0,A.Z)("my-2"),children:(0,D.jsx)(R.Z,{data:"Sent"===v?n:t,id:"active_tab_"+v,sliceData:p})})]})},G=()=>{var e,n,t,m,w,C,P,F,E,_;const{walletTransactions:A,isWalletLoading:O}=(()=>{const{profile:e}=(0,M.Un)(),{data:n,isValidating:t}=(0,N.Z)(null!==e&&void 0!==e&&e.anchor?[e.anchor,"walletPrincipal"]:null,h.C),{data:s,isValidating:l}=(0,o.ZP)(n?[(0,a.PZ)(n),"walletBalance"]:null,(e=>{let[n]=e;return(0,v.sb)(n)}),{dedupingInterval:3e4,focusThrottleInterval:3e4,refreshInterval:3e4}),{transactions:r,isWalletTransactionsLoading:d}=I(),{exchangeRate:c,isValidating:u}=(0,k.G)(),m=(0,i.useMemo)((()=>n?(0,a.PZ)(n):""),[n]);return(0,i.useEffect)((()=>{null!==e&&void 0!==e&&e.anchor&&(0,o.JG)("walletPrincipal")}),[e]),(0,i.useEffect)((()=>{n&&((0,o.JG)("walletBalance"),(0,o.JG)("walletTransactions"))}),[n]),{walletPrincipal:n,walletBalance:s,walletExchangeRate:c,walletTransactions:r,walletAddress:m,isWalletLoading:t||l||d||u}})(),{sendTransactions:S,receiveTransactions:L}=(()=>{const{data:e,...n}=(0,o.ZP)("ethereumTransactions",y),t=(0,i.useMemo)((()=>{var n;return null!==(n=null===e||void 0===e?void 0:e.filter((e=>"send"===e.type)))&&void 0!==n?n:[]}),[e]),a=(0,i.useMemo)((()=>{var n;return null!==(n=null===e||void 0===e?void 0:e.filter((e=>"received"===e.type)))&&void 0!==n?n:[]}),[e]);return{txs:e,sendTransactions:t,receiveTransactions:a,...n}})(),{txs:R}=(()=>{const{data:e,...n}=(0,o.ZP)("btcTransactions",l.Fy);return{txs:e,...n}})(),{txs:V}=(()=>{const{data:e,...n}=(0,o.ZP)("maticTransactions",c.KX);return{txs:e,...n}})(),{erc20txs:$}=(()=>{const{data:e,...n}=(0,o.ZP)("erc20txs",r.ee);return{erc20txs:e,...n}})(),{transactions:q}=(()=>{const{address:e}=(0,x.P)(),{data:n,error:t,isValidating:a}=(0,o.ZP)("user-eth-nft-transactions",b);return{transactions:(0,i.useMemo)((()=>null===n||void 0===n?void 0:n.activities.map((n=>({asset:"NFT",quantity:1,date:(0,u.Z)(new Date(n.date),"MMM dd, yyyy - hh:mm:ss aaa"),from:n.from.replace("ETHEREUM:",""),to:n.to.replace("ETHEREUM:",""),type:n.to.replace("ETHEREUM:","").toLowerCase()===(null===e||void 0===e?void 0:e.toLowerCase())?"received":"send"})))),[e,null===n||void 0===n?void 0:n.activities]),error:t,isValidating:a}})(),{transactions:G}=(()=>{const{address:e}=(0,x.P)(),{data:n,error:t,isValidating:a}=(0,o.ZP)("user-eth-nft-transactions",p);return{transactions:(0,i.useMemo)((()=>null===n||void 0===n?void 0:n.activities.map((n=>({asset:"NFT",quantity:1,date:(0,u.Z)(new Date(n.date),"MMM dd, yyyy - hh:mm:ss aaa"),from:n.from.replace("POLYGON:",""),to:n.to.replace("POLYGON:",""),type:n.to.replace("POLYGON:","").toLowerCase()===(null===e||void 0===e?void 0:e.toLowerCase())?"received":"send"})))),[e,null===n||void 0===n?void 0:n.activities]),error:t,isValidating:a}})(),{erc20txs:H}=(()=>{const{data:e,...n}=(0,o.ZP)("erc20txsPolygon",d.ee);return{erc20txs:e,...n}})(),{wallets:J}=(0,Z.w)(),W=(0,s.TH)(),[Y,z]=(0,i.useState)([]),[Q,X]=(0,i.useState)([]),K=(0,i.useMemo)((()=>!!J.length&&(!Y.length||!!Y.find((e=>{var n;return(null===e||void 0===e?void 0:e.value)===(0,a.PZ)(null===(n=J[0])||void 0===n?void 0:n.principal)})))),[Y,J]),ee=(0,i.useMemo)((()=>{var e,n,t,i,s,l;const o=T({transactions:null!==A&&void 0!==A?A:{totalCount:0,transactions:[]},accounts:Y.length?Y.map((e=>e.value)):J.map((e=>(0,a.PZ)(e.principal)))}),r=K?S:[],d=K&&null!==(e=null===R||void 0===R?void 0:R.sendTransactions)&&void 0!==e?e:[],c=K&&null!==(n=null===$||void 0===$?void 0:$.sendTransactions)&&void 0!==n?n:[],u=K&&null!==(t=null===q||void 0===q?void 0:q.filter((e=>"send"===e.type)))&&void 0!==t?t:[],v=K&&null!==(i=null===G||void 0===G?void 0:G.filter((e=>"send"===e.type)))&&void 0!==i?i:[],h=K&&null!==(s=null===H||void 0===H?void 0:H.sendTransactions)&&void 0!==s?s:[],m=K&&null!==(l=null===V||void 0===V?void 0:V.sendTransactions)&&void 0!==l?l:[];if(!Q.length)return(0,f.df)([...o,...r,...d,...c,...u,...v,...h,...m],"MMM dd',' yyyy - hh:mm:ss a");let p=[];return Q.includes("Internet Computer")&&p.push(...o),Q.includes("Ethereum")&&p.push(...r,...c,...u),Q.includes("Polygon")&&p.push(...h,...m,...v),Q.includes("Bitcoin")&&p.push(...d),(0,f.df)(p,"MMM dd',' yyyy - hh:mm:ss a")}),[A,Y,J,K,G,S,null===R||void 0===R?void 0:R.sendTransactions,null===$||void 0===$?void 0:$.sendTransactions,q,Q,null===H||void 0===H?void 0:H.sendTransactions,null===V||void 0===V?void 0:V.sendTransactions]),ne=(0,i.useMemo)((()=>{var e,n,t,i,s,l;const o=j({transactions:null!==A&&void 0!==A?A:{totalCount:0,transactions:[]},accounts:Y.length?Y.map((e=>e.value)):J.map((e=>(0,a.PZ)(e.principal)))}),r=K?L:[],d=K&&null!==(e=null===$||void 0===$?void 0:$.receivedTransactions)&&void 0!==e?e:[],c=K&&null!==(n=null===H||void 0===H?void 0:H.receivedTransactions)&&void 0!==n?n:[],u=K&&null!==(t=null===V||void 0===V?void 0:V.receivedTransactions)&&void 0!==t?t:[],v=K&&null!==(i=null===R||void 0===R?void 0:R.receivedTransactions)&&void 0!==i?i:[],h=K&&null!==(s=null===q||void 0===q?void 0:q.filter((e=>"received"===e.type)))&&void 0!==s?s:[],m=K&&null!==(l=null===G||void 0===G?void 0:G.filter((e=>"received"===e.type)))&&void 0!==l?l:[];if(!Q.length)return(0,f.df)([...o,...r,...v,...d,...h,...m,...c,...u],"MMM dd',' yyyy - hh:mm:ss a");let p=[];return Q.includes("Internet Computer")&&p.push(...o),Q.includes("Ethereum")&&p.push(...r,...d,...h),Q.includes("Bitcoin")&&p.push(...v),Q.includes("Polygon")&&p.push(...c,...u,...m),(0,f.df)(p,"MMM dd',' yyyy - hh:mm:ss a")}),[A,Y,J,K,L,null===$||void 0===$?void 0:$.receivedTransactions,null===H||void 0===H?void 0:H.receivedTransactions,null===V||void 0===V?void 0:V.receivedTransactions,null===R||void 0===R?void 0:R.receivedTransactions,q,G,Q]),te=(0,i.useMemo)((()=>J.map((e=>{var n,t,i,s,l,o,r,d,c,u,v,h,m,p,x,f,g,y;const b=j({transactions:null!==A&&void 0!==A?A:{totalCount:0,transactions:[]},accounts:[(0,a.PZ)(e.principal)]}).length+T({transactions:null!==A&&void 0!==A?A:{totalCount:0,transactions:[]},accounts:[(0,a.PZ)(e.principal)]}).length,w="nfid.one"===e.domain?S.length+L.length+(null!==(n=null===R||void 0===R||null===(t=R.sendTransactions)||void 0===t?void 0:t.length)&&void 0!==n?n:0)+(null!==(i=null===R||void 0===R||null===(s=R.receivedTransactions)||void 0===s?void 0:s.length)&&void 0!==i?i:0)+(null!==(l=null===$||void 0===$||null===(o=$.sendTransactions)||void 0===o?void 0:o.length)&&void 0!==l?l:0)+(null!==(r=null===$||void 0===$||null===(d=$.receivedTransactions)||void 0===d?void 0:d.length)&&void 0!==r?r:0)+(null!==(c=null===H||void 0===H||null===(u=H.sendTransactions)||void 0===u?void 0:u.length)&&void 0!==c?c:0)+(null!==(v=null===H||void 0===H||null===(h=H.receivedTransactions)||void 0===h?void 0:h.length)&&void 0!==v?v:0)+(null!==(m=null===V||void 0===V||null===(p=V.sendTransactions)||void 0===p?void 0:p.length)&&void 0!==m?m:0)+(null!==(x=null===V||void 0===V||null===(f=V.receivedTransactions)||void 0===f?void 0:f.length)&&void 0!==x?x:0)+(null!==(g=null===G||void 0===G?void 0:G.length)&&void 0!==g?g:0)+(null!==(y=null===q||void 0===q?void 0:q.length)&&void 0!==y?y:0)+b:b;return{label:e.label,value:(0,a.PZ)(e.principal),afterLabel:`${w} TXs`}}))),[null===R||void 0===R||null===(e=R.receivedTransactions)||void 0===e?void 0:e.length,null===R||void 0===R||null===(n=R.sendTransactions)||void 0===n?void 0:n.length,null===$||void 0===$||null===(t=$.receivedTransactions)||void 0===t?void 0:t.length,null===$||void 0===$||null===(m=$.sendTransactions)||void 0===m?void 0:m.length,null===H||void 0===H||null===(w=H.receivedTransactions)||void 0===w?void 0:w.length,null===H||void 0===H||null===(C=H.sendTransactions)||void 0===C?void 0:C.length,null===V||void 0===V||null===(P=V.receivedTransactions)||void 0===P?void 0:P.length,null===V||void 0===V||null===(F=V.sendTransactions)||void 0===F?void 0:F.length,L.length,S.length,A,J,G,q]),ae=(0,i.useCallback)((e=>{const n=e.map((e=>te.find((n=>n.value===e))));z(n.filter((e=>void 0!==e)))}),[te]),ie=i.useCallback((e=>{const n=Y.filter((n=>n.label!==e));z(n)}),[Y]);return(0,i.useEffect)((()=>{var e;const n=null===(e=W.state)||void 0===e?void 0:e.wallet;n&&z([n])}),[null===(E=W.state)||void 0===E?void 0:E.wallet]),(0,i.useEffect)((()=>{var e;const n=null===(e=W.state)||void 0===e?void 0:e.blockchain;n&&X([n])}),[null===(_=W.state)||void 0===_?void 0:_.blockchain]),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(B.a,{isLoading:O}),(0,D.jsx)(U,{sentData:ee,receivedData:ne,transactionsFilterOptions:te,setTransactionFilter:ae,selectedTransactionFilter:Y,onChipRemove:ie,blockchainOptions:g.DR,resetBlockchainFilter:()=>X(g.DR),blockchainFilter:Q,setBlockchainFilter:X})]})}},80285:(e,n,t)=>{t.d(n,{Z:()=>c});var a=t(18414),i=t(87273),s=t(82898);const l=t.p+"static/media/arrow.6841536513c8209ea4230cd1055b0668.svg";const o=t.p+"static/media/arrowDisabled.de38d5e2368adca76f6c243f24b39249.svg";var r=t(33693);const d=e=>{let{children:n,isActive:t,onClick:i,disabled:s,className:l}=e;return(0,r.jsx)("div",{className:(0,a.Z)("w-12 h-12 flex items-center justify-center",t?"bg-gray-200 rounded-[6px]":"hover:bg-gray-100  cursor-pointer",s&&"pointer-events-none",l),onClick:i,children:n})},c=e=>{let{data:n,perPage:t=10,sliceData:c}=e;const[u,v]=i.useState(1),h=i.useMemo((()=>Math.round(n.length/t)),[n,t]);return i.useEffect((()=>{const e=n.slice((u-1)*t,(u-1)*t+t);e.length?c(e):(v(1),c([]))}),[u,n,t,c]),(0,r.jsxs)("div",{className:(0,a.Z)("flex items-center justify-end",n.length<t+1&&"hidden"),children:[(0,r.jsx)(d,{disabled:1===u,onClick:()=>v(u-1),className:(0,a.Z)(1!==u&&"rotate-180"),children:(0,r.jsx)(s.Ee,{src:1===u?o:l,alt:"arrow next"})}),Array(h).fill(null).map(((e,n)=>(0,r.jsx)(d,{onClick:()=>v(n+1),isActive:n===u-1,children:n+1},`pagination_box_${n}`))),(0,r.jsx)(d,{disabled:u===h,onClick:()=>v(u+1),className:(0,a.Z)(u===h&&"rotate-180"),children:(0,r.jsx)(s.Ee,{src:u===h?o:l,alt:"arrow previous"})})]})}},47200:(e,n,t)=>{t.d(n,{Z:()=>s});var a=t(18414),i=(t(87273),t(33693));const s=e=>{let{title:n,subTitle:t,children:s,className:l,showChildrenPadding:o=!0,id:r}=e;return(0,i.jsxs)("div",{id:r,className:(0,a.Z)("block border border-gray-200 rounded-xl","py-4 sm:py-[26px]",l),children:[(0,i.jsxs)("div",{className:"px-5",children:[n&&(0,i.jsx)("div",{className:"flex items-center justify-between mb-3 text-xl",children:n}),t&&(0,i.jsx)("div",{className:"flex items-center justify-between mb-4 text-sm leading-5 text-secondary",children:t})]}),(0,i.jsx)("div",{className:(0,a.Z)(o&&"px-5 sm:px-[30px]"),children:s})]})}},35826:(e,n,t)=>{t.d(n,{Jv:()=>o,df:()=>d,zx:()=>r});var a=t(89158),i=t(55558),s=t(22599),l=t(6090);const o=e=>Math.floor(Number(e/BigInt(10**6))),r=(e,n,t)=>n&&!t?(0,a.Z)(e,n):!n&&t?(0,i.Z)(e,t):!n||!t||(0,a.Z)(e,n)&&(0,i.Z)(e,t),d=(e,n)=>e.sort(((e,t)=>{const a=n?(0,s.Z)(e.date,n,new Date):e.date,i=n?(0,s.Z)(t.date,n,new Date):t.date;return(0,l.Z)(a,i)}))}}]);
//# sourceMappingURL=212.73b468d3.chunk.js.map