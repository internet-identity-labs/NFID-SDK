{"version":3,"file":"static/js/299.e8796d7d.chunk.js","mappings":"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","sources":["ui/pages/request-accounts/nfid.svg","ui/pages/request-accounts/index.tsx","apps/identity-manager/request-accounts/index.tsx","state/machines/wallet/request-accounts.ts","coordination/wallet/request-accounts.tsx","ui/utils/use-timer.ts"],"sourcesContent":["var _path, _defs;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgNfid(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 25,\n    height: 25,\n    viewBox: \"0 0 25 25\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M6.29434 1.77834C6.62025 1.7436 6.85629 1.45123 6.82154 1.12532C6.78679 0.799406 6.49442 0.563373 6.16851 0.59812L4.95651 0.72734C4.33556 0.79354 3.83752 0.846635 3.43304 0.919969C3.01636 0.995515 2.65925 1.09878 2.32758 1.28466C1.78908 1.58645 1.34265 2.02868 1.036 2.56423C0.847098 2.89414 0.740737 3.25016 0.661669 3.66585C0.584928 4.06931 0.52769 4.56636 0.456341 5.18596L0.453267 5.21265L0.33426 6.39617C0.301469 6.72229 0.539252 7.01324 0.865364 7.04603C1.19148 7.07882 1.48243 6.84103 1.51522 6.51492L1.63337 5.33993C1.70764 4.69502 1.76018 4.24249 1.82768 3.88764C1.89392 3.53938 1.96786 3.32542 2.06602 3.15399C2.26579 2.80509 2.55673 2.51683 2.90784 2.32006C3.08045 2.22333 3.29544 2.15118 3.64478 2.08784C4.00147 2.02317 4.45625 1.97432 5.10475 1.90517L6.29434 1.77834ZM17.8415 1.12532C17.8068 1.45123 18.0428 1.7436 18.3687 1.77834L19.5583 1.90517C20.2068 1.97432 20.6616 2.02317 21.0183 2.08784C21.3676 2.15118 21.5826 2.22333 21.7552 2.32006C22.1063 2.51683 22.3973 2.80509 22.597 3.15399C22.6952 3.32542 22.7691 3.53938 22.8354 3.88764C22.9029 4.24249 22.9554 4.69502 23.0297 5.33993L23.1478 6.51492C23.1806 6.84103 23.4716 7.07882 23.7977 7.04603C24.1238 7.01324 24.3616 6.72229 24.3288 6.39617L24.2098 5.21265L24.2067 5.18596L24.2067 5.18589L24.2067 5.18578L24.2067 5.18558C24.1353 4.56616 24.0781 4.06923 24.0014 3.66585C23.9223 3.25016 23.816 2.89414 23.6271 2.56423C23.3204 2.02868 22.874 1.58645 22.3355 1.28466C22.0038 1.09878 21.6467 0.995515 21.23 0.919969C20.8255 0.846635 20.3275 0.79354 19.7065 0.72734L18.4945 0.59812C18.1686 0.563373 17.8763 0.799406 17.8415 1.12532ZM17.8415 24.0641C17.8068 23.7382 18.0428 23.4459 18.3687 23.4111L19.5583 23.2843C20.2068 23.2151 20.6616 23.1663 21.0183 23.1016C21.3676 23.0383 21.5826 22.9661 21.7552 22.8694C22.1063 22.6726 22.3973 22.3844 22.597 22.0355C22.6952 21.864 22.7691 21.6501 22.8354 21.3018C22.9029 20.947 22.9554 20.4944 23.0297 19.8495L23.1478 18.6745C23.1806 18.3484 23.4716 18.1106 23.7977 18.1434C24.1238 18.1762 24.3616 18.4672 24.3288 18.7933L24.2098 19.9768L24.2067 20.0035L24.2067 20.0036L24.2067 20.0037C24.1354 20.6232 24.0781 21.1202 24.0014 21.5236C23.9223 21.9393 23.816 22.2953 23.6271 22.6252C23.3204 23.1608 22.874 23.603 22.3355 23.9048C22.0038 24.0907 21.6467 24.1939 21.23 24.2695C20.8255 24.3428 20.3275 24.3959 19.7065 24.4621L18.4945 24.5913C18.1686 24.6261 17.8763 24.39 17.8415 24.0641ZM6.82154 24.0641C6.85629 23.7382 6.62025 23.4459 6.29434 23.4111L5.10475 23.2843C4.45625 23.2151 4.00147 23.1663 3.64478 23.1016C3.29544 23.0383 3.08045 22.9661 2.90784 22.8694C2.55673 22.6726 2.26579 22.3844 2.06602 22.0355C1.96786 21.864 1.89392 21.6501 1.82768 21.3018C1.76018 20.947 1.70764 20.4944 1.63337 19.8495L1.51522 18.6745C1.48243 18.3484 1.19148 18.1106 0.865364 18.1434C0.539252 18.1762 0.301469 18.4672 0.33426 18.7933L0.453267 19.9768L0.456341 20.0035C0.52769 20.6231 0.584928 21.1201 0.661669 21.5236C0.740737 21.9393 0.847098 22.2953 1.036 22.6252C1.34265 23.1608 1.78908 23.603 2.32758 23.9048C2.65925 24.0907 3.01636 24.1939 3.43304 24.2695C3.83752 24.3428 4.33556 24.3959 4.95651 24.4621L6.16851 24.5913C6.49442 24.6261 6.78679 24.39 6.82154 24.0641ZM6.98626 8.01901C6.43398 8.01901 5.98626 8.46673 5.98626 9.01901V16.3454C5.98626 16.8977 6.43398 17.3454 6.98626 17.3454H7.6243C8.17659 17.3454 8.6243 16.8977 8.6243 16.3454V9.01901C8.6243 8.46673 8.17659 8.01901 7.6243 8.01901H6.98626ZM11.3575 8.01901C10.8052 8.01901 10.3575 8.46673 10.3575 9.01901V16.3454C10.3575 16.8977 10.8052 17.3454 11.3575 17.3454H14.7675C15.789 17.3454 16.695 17.1544 17.4855 16.7725C18.276 16.3906 18.8889 15.8488 19.3241 15.1471C19.7594 14.4453 19.977 13.6237 19.977 12.6822C19.977 11.7407 19.7594 10.9191 19.3241 10.2174C18.8889 9.51568 18.276 8.97386 17.4855 8.59192C16.695 8.20998 15.789 8.01901 14.7675 8.01901H11.3575ZM16.5795 14.5608C16.0999 15.0138 15.4603 15.2403 14.6609 15.2403H13.2955C13.1298 15.2403 12.9955 15.106 12.9955 14.9403V10.4241C12.9955 10.2584 13.1298 10.1241 13.2955 10.1241H14.6609C15.4603 10.1241 16.0999 10.3506 16.5795 10.8036C17.068 11.2566 17.3123 11.8828 17.3123 12.6822C17.3123 13.4816 17.068 14.1078 16.5795 14.5608Z\",\n    fill: \"url(#paint0_linear_29161_36359)\"\n  })), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    id: \"paint0_linear_29161_36359\",\n    x1: 6.10064,\n    y1: 8.58179,\n    x2: 14.339,\n    y2: 20.5563,\n    gradientUnits: \"userSpaceOnUse\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#CC5CDC\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 0.244792,\n    stopColor: \"#7B66FF\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 0.520833,\n    stopColor: \"#1F8AF0\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 0.760417,\n    stopColor: \"#00D1FF\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 1,\n    stopColor: \"#3DEDD7\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgNfid);\nexport default __webpack_public_path__ + \"static/media/nfid.2546d441d77e8702acfb8302ccf464ab.svg\";\nexport { ForwardRef as ReactComponent };","import clsx from \"clsx\"\n\nimport { IOption, DropdownSelect, SDKApplicationMeta } from \"@nfid-frontend/ui\"\nimport { ScreenResponsive } from \"@nfid-frontend/ui\"\nimport { Image } from \"@nfid-frontend/ui\"\n\nimport { Button } from \"frontend/ui/atoms/button\"\nimport { BlurredLoader } from \"frontend/ui/molecules/blurred-loader\"\n\nimport NFIDLogo from \"./nfid.svg\"\n\nexport interface SDKRequestAccountsPageProps {\n  applicationName?: string\n  applicationLogo?: string\n  onReject: () => void\n  onApprove: () => void\n  accountsOptions: IOption[]\n  selectedAccounts: string[]\n  setSelectedAccounts: (value: string[]) => void\n  timer: number | boolean\n}\n\nexport const SDKRequestAccountsPage: React.FC<SDKRequestAccountsPageProps> = ({\n  applicationLogo,\n  applicationName,\n  onReject,\n  onApprove,\n  accountsOptions,\n  selectedAccounts,\n  setSelectedAccounts,\n  timer = false,\n}) => {\n  return (\n    <ScreenResponsive frameLabel=\"Approve with NFID\">\n      <BlurredLoader isLoading={!accountsOptions.length}>\n        <div\n          className={clsx(\n            \"flex flex-col flex-grow lg:justify-between\",\n            \"h-full\",\n          )}\n        >\n          <div>\n            <SDKApplicationMeta\n              applicationLogo={applicationLogo}\n              title={applicationName}\n              subTitle=\"wants to perform the following actions:\"\n            />\n            <div\n              className={clsx(\"border border-gray-300 rounded-md\", \"p-3 mt-4\")}\n            >\n              <div className=\"flex space-x-2.5 mb-2.5\">\n                <div\n                  className={clsx(\n                    \"w-10 h-10 bg-gray-50 rounded-full\",\n                    \"flex items-center justify-center\",\n                    \"relative\",\n                  )}\n                >\n                  <Image className=\"w-6\" src={NFIDLogo} alt=\"nfid\" />\n                </div>\n                <div>\n                  <p className=\"text-sm font-semibold\">\n                    View your Web3 balance\n                  </p>\n                  <p className=\"text-xs text-secondary\">\n                    This site will see tokens and history from your selected\n                    accounts\n                  </p>\n                </div>\n              </div>\n              <DropdownSelect\n                disabled={timer !== -1}\n                isSearch\n                options={accountsOptions}\n                selectedValues={selectedAccounts}\n                setSelectedValues={setSelectedAccounts}\n                placeholder=\"None selected - connect anonymously\"\n                showSelectAllOption\n              />\n            </div>\n          </div>\n          <div\n            className={clsx(\n              \"grid grid-cols-2 gap-5 mt-5 lg:mt-32\",\n              timer !== -1 && \"hidden\",\n            )}\n          >\n            <Button stroke onClick={onReject}>\n              Reject\n            </Button>\n            <Button primary onClick={onApprove}>\n              Approve\n            </Button>\n          </div>\n\n          <Button\n            className={clsx(\"mt-5 lg:mt-32\", timer === -1 && \"hidden\")}\n            block\n            primary\n          >\n            Success! Closing in {timer}\n          </Button>\n        </div>\n      </BlurredLoader>\n    </ScreenResponsive>\n  )\n}\n","import { principalToAddress } from \"ictool\"\nimport { useCallback, useMemo, useState } from \"react\"\n\nimport { IOption } from \"@nfid-frontend/ui\"\nimport { toPresentation } from \"@nfid/integration/token/icp\"\n\nimport { useAllWallets } from \"frontend/integration/wallet/hooks/use-all-wallets\"\nimport { SDKRequestAccountsPage } from \"frontend/ui/pages/request-accounts\"\nimport { useTimer } from \"frontend/ui/utils/use-timer\"\n\ninterface IRequestAccounts {\n  applicationName?: string\n  applicationLogo?: string\n  onSuccess: (accounts: string[]) => void\n}\n\nexport const RequestAccounts = ({\n  applicationLogo,\n  applicationName,\n  onSuccess,\n}: IRequestAccounts) => {\n  const [selectedAccounts, setSelectedAccounts] = useState<string[]>([])\n  const { wallets } = useAllWallets()\n  const { counter, setCounter } = useTimer({ defaultCounter: -1 })\n\n  const accountsOptions: IOption[] | undefined = useMemo(() => {\n    return wallets?.map((wallet) => ({\n      label: wallet.label ?? \"\",\n      value: principalToAddress(wallet.principal) ?? \"\",\n      afterLabel: `${toPresentation(wallet.balance[\"ICP\"])} ICP`,\n    }))\n  }, [wallets])\n\n  const onApprove = useCallback(() => {\n    setCounter(5)\n    setTimeout(() => {\n      return onSuccess(selectedAccounts)\n    }, 5000)\n  }, [setCounter, onSuccess, selectedAccounts])\n\n  return (\n    <SDKRequestAccountsPage\n      applicationName={applicationName}\n      applicationLogo={applicationLogo}\n      onReject={() => window.close()}\n      onApprove={onApprove}\n      accountsOptions={accountsOptions ?? []}\n      selectedAccounts={selectedAccounts}\n      setSelectedAccounts={setSelectedAccounts}\n      timer={counter}\n    />\n  )\n}\n","import { ActorRefFrom, assign, createMachine } from \"xstate\"\n\nimport { registerRequestAccountsHandler } from \"@nfid/wallet\"\n\nimport { AuthSession } from \"frontend/state/authentication\"\nimport { AuthorizingAppMeta } from \"frontend/state/authorization\"\n\nimport AuthenticationMachine from \"../authentication/authentication\"\n\ninterface Context {\n  appMeta?: AuthorizingAppMeta\n  authSession?: AuthSession\n  requestAccounts?: string\n  isLoading?: boolean\n  accounts?: string[]\n}\n\nlet accounts: string[] | undefined = undefined\n\n// Definition of events usable in the machine.\ntype Events =\n  | {\n      type: \"done.invoke.AuthenticationMachine\"\n      data: AuthSession\n    }\n  | {\n      type: \"done.invoke.registerRequestAccountsHandler\"\n      data: string\n    }\n  | { type: \"SUCCESS\"; accounts: string[] }\n  | { type: \"REJECT\" }\n  | { type: \"END\" }\n\n/** @xstate-layout N4IgpgJg5mDOIC5QCUwEcCucAuBBAxvgPYYB22sACgE5EBuAlhGNQHSoCGEAngMQRFSYVg1J0iAa2HUwUBrGwtUmHAWJkKACQ6kIAGxYBtAAwBdRKAAORWA2wNBFkAA9EAFgDMAdlYBOf75evh6+AGweAEweABwArAA0INyIwayxAIzpXh7pwemhGR4AvkWJylgKaiTkVLSMzGy4GNgAFmDkDPgcivyCwqLiUqxNre32XfaCALIc+C2iYCbmSCDWtpOkTq4ImdERrOnRXrHGob7psb5uEdGJyQipGVk5eQXpxaUg5aqE1RQ09CYLHY6AqeF+GlgvAAygBVADC8IAotDoUsnGs7A5NittvlPKxjl5oulrmFYns3HcUh40plsrkcm8Pp9SERmPAVt9KhCagD6sDODwMTYsY5ce4ItSEHs-AErjEIp49h8yqCfuo+XUgY1mm0OhMwCL1titohiaEDkc3F4lekIr5onFpbL5QrKYrVV91TzNf9tQ0QSpfX9OVZRRszTs3KF0qw3AEvEnoiFDlSkoh6WljDmMm5Kflom4Smrg+C-bVAYGkbpjWKcaA8UnLcFjh5jG4Y7EKdKszmc+9zl57bavdzy6H+Tq65GJQgALShaWLkolIA */\nconst RequestAccountsMachine = createMachine(\n  {\n    context: {} as Context,\n    tsTypes: {} as import(\"./request-accounts.typegen\").Typegen0,\n    schema: { events: {} as Events },\n    initial: \"Ready\",\n    states: {\n      Ready: {\n        invoke: {\n          src: \"registerRequestAccountsHandler\",\n          id: \"registerRequestAccountsHandler\",\n          onDone: [\n            {\n              target: \"Authenticate\",\n              actions: \"assignRequestAccountsRequest\",\n            },\n          ],\n        },\n      },\n      Authenticate: {\n        invoke: {\n          src: \"AuthenticationMachine\",\n          id: \"AuthenticationMachine\",\n          onDone: [\n            {\n              target: \"RequestAccounts\",\n              actions: \"assignAuthSession\",\n            },\n          ],\n          data: (context) => ({\n            appMeta: context.appMeta,\n          }),\n        },\n      },\n      RequestAccounts: {\n        on: {\n          SUCCESS: {\n            target: \"Confirm\",\n            actions: \"assignAccounts\",\n          },\n        },\n      },\n      Confirm: {\n        onEntry: \"setAccounts\",\n      },\n      End: {\n        type: \"final\",\n      },\n    },\n    id: \"RequestAccountsProvider\",\n  },\n  {\n    actions: {\n      assignAuthSession: assign((_, event) => ({\n        authSession: event.data,\n      })),\n      assignRequestAccountsRequest: assign({\n        requestAccounts: (_, event) => event.data,\n      }),\n      assignAccounts: assign({\n        accounts: (_, event) => event.accounts,\n      }),\n      setAccounts: (data) => {\n        console.log({ accounts, data })\n        accounts = data.accounts\n      },\n    },\n    services: {\n      async registerRequestAccountsHandler() {\n        const params = await registerRequestAccountsHandler(() => {\n          return new Promise((resolve) => {\n            setInterval(() => {\n              if (accounts) {\n                resolve({\n                  status: \"SUCCESS\",\n                  accounts: accounts,\n                })\n              }\n            }, 1000)\n          })\n        })\n        console.debug(\"registerRequestAccountsHandler\", { params })\n        return params\n      },\n      AuthenticationMachine,\n    },\n    guards: {},\n  },\n)\n\nexport default RequestAccountsMachine\n\nexport type RequestAccountsMachineActor = ActorRefFrom<\n  typeof RequestAccountsMachine\n>\n\nexport type RequestAccountsMachineType = typeof RequestAccountsMachine\n","import { useMachine } from \"@xstate/react\"\nimport { useEffect } from \"react\"\nimport { useSearchParams } from \"react-router-dom\"\n\nimport { ScreenResponsive } from \"@nfid-frontend/ui\"\n\nimport { RequestAccounts } from \"frontend/apps/identity-manager/request-accounts\"\nimport { AuthenticationActor } from \"frontend/state/machines/authentication/authentication\"\nimport RequestAccountsMachine from \"frontend/state/machines/wallet/request-accounts\"\nimport { BlurredLoader } from \"frontend/ui/molecules/blurred-loader\"\n\nimport { AuthenticationCoordinator } from \"../authentication\"\n\nexport default function RequestAccountsCoordinator() {\n  const [searchParams] = useSearchParams()\n  const applicationName = searchParams.get(\"applicationName\")\n  const applicationLogo = searchParams.get(\"applicationLogo\")\n\n  const [state, send] = useMachine(\n    RequestAccountsMachine.withConfig(\n      {},\n      {\n        appMeta: { name: applicationName || \"\", logo: applicationLogo || \"\" },\n      },\n    ),\n  )\n\n  useEffect(() => {\n    console.debug(\"RequestAccountsCoordinator\", { state: state.value })\n  }, [state])\n\n  switch (true) {\n    case state.matches(\"Ready\"):\n      return (\n        <BlurredLoader\n          isLoading\n          loadingMessage={`Connecting to ${\n            state.context?.appMeta?.name ?? \"the application\"\n          }`}\n        />\n      )\n    case state.matches(\"Authenticate\"):\n      return (\n        <ScreenResponsive>\n          <AuthenticationCoordinator\n            actor={state.children.AuthenticationMachine as AuthenticationActor}\n            enforceSingleAccountScreen\n          />\n        </ScreenResponsive>\n      )\n    case state.matches(\"RequestAccounts\"):\n      return (\n        <RequestAccounts\n          applicationName={state.context?.appMeta?.name}\n          applicationLogo={state.context.appMeta?.logo}\n          onSuccess={(accounts: string[]) => {\n            send({ type: \"SUCCESS\", accounts: accounts })\n          }}\n        />\n      )\n    default:\n      console.debug(\n        `RequestAccounts rendering loader, unknown state: ${JSON.stringify(\n          state.value,\n        )}`,\n      )\n      return <BlurredLoader isLoading />\n  }\n}\n","import React from \"react\"\n\ninterface useTimerProps {\n  defaultCounter: number\n  frequency?: number\n  loop?: boolean\n  onElapsed?: () => void\n}\n\nexport const useTimer = ({\n  defaultCounter,\n  loop,\n  frequency = 1000,\n  onElapsed,\n}: useTimerProps) => {\n  const [counter, setCounter] = React.useState(defaultCounter)\n  const timer = React.useRef<NodeJS.Timer>()\n  const [elapsed, setElapsed] = React.useState(false)\n\n  const handleInterval = React.useCallback(() => {\n    if (counter > 0) {\n      setCounter(counter - 1)\n    }\n\n    if (counter === 0) {\n      setElapsed(true)\n      onElapsed && onElapsed()\n      clearInterval(Number(timer.current))\n    }\n\n    if (counter === 0 && loop) {\n      setCounter(defaultCounter)\n      timer.current = setInterval(handleInterval, frequency)\n      setElapsed(false)\n    }\n  }, [counter, defaultCounter, frequency, loop, onElapsed])\n\n  React.useEffect(() => {\n    timer.current = setInterval(handleInterval, frequency)\n    return () => clearInterval(Number(timer.current))\n  }, [frequency, handleInterval])\n\n  return { elapsed, setCounter, counter }\n}\n"],"names":["SDKRequestAccountsPage","applicationLogo","applicationName","onReject","onApprove","accountsOptions","selectedAccounts","setSelectedAccounts","timer","frameLabel","B","isLoading","length","className","clsx","title","subTitle","src","NFIDLogo","alt","disabled","isSearch","options","selectedValues","setSelectedValues","placeholder","showSelectAllOption","stroke","onClick","primary","block","RequestAccounts","onSuccess","useState","wallets","useAllWallets","counter","setCounter","useTimer","defaultCounter","useMemo","map","wallet","label","value","principalToAddress","principal","afterLabel","toPresentation","balance","useCallback","setTimeout","window","close","accounts","createMachine","context","tsTypes","schema","events","initial","states","Ready","invoke","id","onDone","target","actions","Authenticate","data","appMeta","on","SUCCESS","Confirm","onEntry","End","type","assignAuthSession","assign","_","event","authSession","assignRequestAccountsRequest","requestAccounts","assignAccounts","setAccounts","console","log","services","async","params","registerRequestAccountsHandler","Promise","resolve","setInterval","status","debug","AuthenticationMachine","guards","RequestAccountsCoordinator","searchParams","useSearchParams","get","state","send","useMachine","RequestAccountsMachine","name","logo","useEffect","matches","loadingMessage","actor","children","enforceSingleAccountScreen","JSON","stringify","loop","frequency","onElapsed","React","elapsed","setElapsed","handleInterval","clearInterval","Number","current"],"sourceRoot":""}