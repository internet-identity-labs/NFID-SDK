"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[812],{13485:(a,n,t)=>{t.d(n,{Z:()=>e});t(87273);const e=t.p+"static/media/dfinity.583ab84ba16070ca501453d1e291dff4.svg"},19864:(a,n,t)=>{t.d(n,{i:()=>i});var e=t(94244),o=t(8708);const i=()=>{const{data:a,isValidating:n}=(0,e.ZP)("dip20AllToken",o.o4,{dedupingInterval:36e5,focusThrottleInterval:36e5});return console.debug("useAllDip20Token",{token:a}),{token:a,isValidating:n}}},52510:(a,n,t)=>{t.d(n,{A:()=>i});var e=t(40462),o=t(94244);const i=()=>{const{data:a,...n}=(0,o.ZP)("erc20Polygon",e.lI);return{erc20:a,...n}}},63071:(a,n,t)=>{t.d(n,{R:()=>i});var e=t(97720),o=t(94244);const i=()=>{const{data:a,...n}=(0,o.ZP)("erc20",e.lI);return{erc20:a,...n}}},22245:(a,n,t)=>{t.d(n,{k:()=>s});var e=t(82898),o=t(78765),i=t(7863),l=t(33368),r=t(25390),c=t(23439);const s=async()=>{var a;const n=null!==(a=(0,o.SC)())&&void 0!==a?a:await(0,c.In)(),t=await(0,r.p)(null===n||void 0===n?void 0:n.anchor,"nfid.one","0"),e=await o.q_.getBalance(void 0,t),i=await o.q_.getAddress(t),l=(await(0,r.p)(n.anchor)).getPrincipal().toText();return d(e,i,l)},d=async(a,n,t)=>{var o,r,c,s;const d=BigInt(Number(null!==(o=null===(r=a.balance)||void 0===r?void 0:r.toFixed(8))&&void 0!==o?o:0)*i.EZ),u="$"+(null!==(c=null===(s=a.balanceinUsd)||void 0===s?void 0:s.toFixed(2))&&void 0!==c?c:"0.00");return{applications:{NFID:{accounts:[{accountName:"account 1",address:null!==n&&void 0!==n?n:"",principalId:t,tokenBalance:d,usdBalance:u}],appName:"NFID",tokenBalance:d}},icon:e.kD,label:"Ethereum",token:l.v.ETH,tokenBalance:d,usdBalance:u,blockchain:"Ethereum"}}},78693:(a,n,t)=>{t.d(n,{P:()=>p});var e=t(94244),o=t(69491),i=t(78765);const l="nfid_address_cache",r=()=>{const a=localStorage.getItem(l);return a?JSON.parse(a):{}},c=a=>{let{hostname:n,accountId:t,anchor:e}=a;return`${e}:${(0,i.bR)(n,t)}`},s=a=>{const n=r();return"object"===typeof n[a]?n[a]:{}};var d=t(25390);const u=async a=>{const n="nfid.one",t=(a=>{let{accountId:n,anchor:t,hostname:e,network:o}=a;const i=c({hostname:e,accountId:n,anchor:t});return s(i)[o]})({accountId:"0",hostname:n,anchor:BigInt(a),network:"ETH"});if(t)return t;const e=await(0,d.p)(a,n,"0");(0,i.Ru)(i.v6,e);const o=await i.q_.getAddress(e);return!t&&(a=>{let{hostname:n,anchor:t,accountId:e,address:o,network:i}=a;const d=r(),u=c({hostname:n,anchor:t,accountId:e}),p=s(u);localStorage.setItem(l,JSON.stringify({...d,[u]:{...p,[i]:o}}))})({address:o,accountId:"0",hostname:n,anchor:BigInt(a),network:"ETH"}),o},p=()=>{const{profile:a}=(0,o.Un)(),{data:n,...t}=(0,e.ZP)(null!==a&&void 0!==a&&a.anchor?[a.anchor]:null,(a=>{let[n]=a;return u(n)}));return{address:n,...t}}},94159:(a,n,t)=>{t.d(n,{A1:()=>u,J4:()=>d,SP:()=>p});var e=t(13791),o=t(54915),i=t(56386),l=t(47047),r=t(78765),c=t(8708),s=t(22245);async function d(a){let{principals:n,dip20Token:t,erc20:e,erc20Polygon:d}=a;return await Promise.all(n.map((async a=>{let{principal:n,account:u}=a;const p=await Promise.all([...["ICP"].map((async a=>({[a]:await(0,r.sb)((0,o.PZ)(n))}))),...["ETH"].map((async a=>({[a]:(await(0,s.k)()).tokenBalance}))),...["BTC"].map((async a=>({[a]:(await(0,i.T8)()).tokenBalance}))),...["MATIC"].map((async a=>({[a]:(await(0,l.X9)()).tokenBalance}))),...t.map((async a=>{let{symbol:t,canisterId:e}=a;return{[t]:await(0,c.li)({canisterId:e,principalId:n.toText()})}})),...e.map((async a=>({[a.token]:a.tokenBalance}))),...d.map((async a=>({[a.token]:a.tokenBalance})))]);return{principal:n,principalId:n.toText(),account:u,balance:p.reduce(((a,n)=>({...a,...n})),{})}})))}async function u(a){return await Promise.all(a.map((async a=>{var n;const t=e.Principal.fromText(VAULT_CANISTER_ID),i=(0,o.PZ)(t,(0,o.Wu)(a.uid)),l=await(0,r.sb)(i);return{principal:t,account:{domain:"nfid.vaults",label:null!==(n=a.name)&&void 0!==n?n:"",accountId:a.uid},principalId:t.toText(),address:i,balance:{ICP:l},vaultId:null===a||void 0===a?void 0:a.vaultId,vaultName:null===a||void 0===a?void 0:a.vaultName}})))}async function p(a){return await Promise.all(a.map((async a=>{const n=e.Principal.fromText(VAULT_CANISTER_ID),t=await(0,r.sb)((0,o.PZ)(n,(0,o.Wu)(a.uid)));return{...a,address:(0,o.PZ)(n,(0,o.Wu)(a.uid)),balance:{ICP:t}}})))}},14868:(a,n,t)=>{t.d(n,{j:()=>s});var e=t(63071),o=t(52510),i=t(94244),l=t(94159),r=t(65794),c=t(19864);const s=()=>{const{principals:a}=(0,r.J)(),{token:n}=(0,c.i)(),{erc20:t}=(0,e.R)(),{erc20:s}=(0,o.A)(),{data:d,isValidating:u,mutate:p}=(0,i.ZP)(n&&a&&t&&s?[a,n,t,s,"AllBalanceRaw"]:null,(async a=>{let[n,e]=a;return console.debug("AllBalanceRaw",{principals:n,dip20Token:e,erc20:t}),await(0,l.J4)({principals:n,dip20Token:e,erc20:t||[],erc20Polygon:s||[]})}),{dedupingInterval:3e4,refreshInterval:6e4});return{balances:d,isLoading:u,refreshBalances:p}}},33492:(a,n,t)=>{t.d(n,{I:()=>r});var e=t(94244),o=t(36516),i=t(78765),l=t(25390);const r=(a,n,t)=>(0,e.ZP)(a?[a,n,t]:null,(a=>{let[n,t,e]=a;return(0,l.p)(n,t,e)}),{refreshInterval:o.EW,onSuccess:async a=>(a&&await(0,i.Ru)(i.UT,a),a)})},69491:(a,n,t)=>{t.d(n,{xe:()=>r,AC:()=>d,pq:()=>s,Un:()=>c});var e=t(87273),o=t(94244),i=t(23439),l=t(75205);function r(){const{data:a,isValidating:n,error:t}=(0,o.ZP)("accounts",i.pO);return{accounts:a,isLoading:n,error:t}}function c(){const{data:a,error:n,mutate:t}=(0,o.ZP)("account/fetch",i.In,{dedupingInterval:6e4,focusThrottleInterval:6e4});return{isLoading:!a&&!n,refreshProfile:t,profile:a}}function s(a){const{data:n,error:t,mutate:e}=(0,o.ZP)(["applications/meta",a],(a=>{let[,n]=a;return(0,i.sH)(n)}),{dedupingInterval:3e5,focusThrottleInterval:3e5});return{isLoading:!n&&!t,refreshApplicationMeta:e,applicationsMeta:n}}const d=()=>{const{isLoading:a,applicationsMeta:n}=s(),{isLoading:t,profile:o}=c(),r=e.useMemo((()=>((a,n)=>{const t=a.reduce(((a,t)=>{const e=null===n||void 0===n?void 0:n.find((a=>{let{domain:n}=a;return(0,i.Lp)(n)===(0,i.Lp)(t.domain)})),o=null!==e&&void 0!==e&&e.domain?(0,l.Gr)(e.domain).host:(0,l.Gr)(t.domain).host,r=a[o]||[];return a[o]=[...r,{...t,applicationName:(null===e||void 0===e?void 0:e.name)||o,alias:null===e||void 0===e?void 0:e.alias,icon:null===e||void 0===e?void 0:e.icon}],a}),{}),e=Object.entries(t).map((a=>{let[n,t]=a;return{applicationName:t[0].applicationName,accountsCount:t.length,derivationOrigin:t[0].domain,icon:t[0].icon,aliasDomains:(t[0].alias||[]).map((a=>(0,l.Gr)(a).host))}})).sort(((a,n)=>{let{applicationName:t}=a,{applicationName:e}=n;return t<e?1:-1}));return e})((null===o||void 0===o?void 0:o.accounts)||[],n||[])),[null===o||void 0===o?void 0:o.accounts,n]);return{isLoading:a||t,applicationAccounts:r}}},65794:(a,n,t)=>{t.d(n,{J:()=>r});var e=t(87273),o=t(72422),i=t(78765),l=t(69491);const r=()=>{const{profile:a}=(0,l.Un)(),{accounts:n}=(0,l.xe)(),{applicationsMeta:t}=(0,l.pq)(),r=e.useMemo((()=>(0,i.XZ)(n,t)),[n,t]),{data:c}=(0,o.Z)(null!==a&&void 0!==a&&a.anchor&&r?[BigInt(a.anchor),r]:null,(a=>{let[n,t]=a;return(0,i.bt)(n,t)}),{dedupingInterval:6e4,refreshInterval:6e4});return console.debug("useAllPrincipals",{principals:c}),{principals:c}}},23210:(a,n,t)=>{t.d(n,{w:()=>I});var e=t(54915),o=t(87273),i=t(56386),l=t(72422);var r=t(78765),c=t(78693),s=t(14868),d=t(94244),u=t(94159),p=t(69491),v=t(33492);var m=t(93441);const I=()=>{const{balances:a,isLoading:n}=(0,s.j)(),{balances:t,isLoading:I}=(()=>{const{profile:a}=(0,p.Un)(),{data:n}=(0,v.I)(null===a||void 0===a?void 0:a.anchor),{data:t,isLoading:e}=(0,d.ZP)(n?"allVaultsWallets":null,(async()=>{const a=await(0,r._w)(),n=null===a||void 0===a?void 0:a.map((async a=>(await(0,r.MX)(a.id)).map((n=>({...n,vaultId:a.id,vaultName:a.name})))));return(await Promise.all(n)).flat(1).filter((a=>a.state!==r.Q$.ARCHIVED))})),{data:o,isValidating:i}=(0,d.ZP)(t?[t,"allVaultsWalletsBalances"]:null,(async a=>{let[n]=a;return console.debug("allVaultsWalletsBalances",{allVaultsWallets:n}),await(0,u.A1)(n)}),{dedupingInterval:3e4,refreshInterval:6e4});return{balances:o,isLoading:e||i}})(),{address:g}=(0,c.P)(),{btcAddress:h}=(()=>{const{data:a,...n}=(0,l.Z)("btcAddress",i.$J);return{btcAddress:a,...n}})(),f=(0,p.pq)();return{wallets:o.useMemo((()=>{var n;if(!a||!t)return[];const o=null===a||void 0===a?void 0:a.map((a=>{var n;let{principal:t,account:o,...i}=a;return{label:(0,r.w)(null!==(n=f.applicationsMeta)&&void 0!==n?n:[],o.domain,o.accountId),accountId:o.accountId,domain:o.domain,principal:t,address:(0,e.PZ)(t),ethAddress:g,btcAddress:h,...i}})).sort((0,m.E)((a=>{let{label:n}=a;return null!==n&&void 0!==n?n:""}))).concat(null!==(n=null===t||void 0===t?void 0:t.map((a=>{let{principal:n,account:t,address:e,...o}=a;return{label:t.label,accountId:t.accountId,domain:t.domain,principal:n,address:null!==e&&void 0!==e?e:t.accountId,isVaultWallet:!0,ethAddress:e,btcAddress:h,...o}})))&&void 0!==n?n:[]);return(0,m.h)((a=>{let{label:n}=a;return null!==n&&void 0!==n?n:""}),["NFID","NNS"])(o||[])}),[g,f.applicationsMeta,a,t,h]),isLoading:n||I}}},75205:(a,n,t)=>{t.d(n,{Gr:()=>l,g_:()=>i});var e=t(20964),o=t.n(e);const i=()=>o().getParser(window.navigator.userAgent).getBrowser().name,l=a=>(/^(http|https):\/\//.test(a)||(a=`${window.location.protocol}//${a}`),new URL(a))},93441:(a,n,t)=>{t.d(n,{E:()=>e,h:()=>o});const e=a=>(n,t)=>a(n).localeCompare(a(t),"en",{sensitivity:"base"}),o=(a,n)=>t=>{const e=n.map((n=>t.find((t=>a(t).includes(n))))).filter((a=>Boolean(a)));return[...e,...t.filter((n=>!e.find((t=>a(t)===a(n)))))]}},33368:(a,n,t)=>{let e;t.d(n,{v:()=>e}),function(a){a.ICP="ICP",a.DIP20="DIP20",a.ETH="ETH",a.MATIC="MATIC",a.BTC="BTC",a.ERC20_ETHEREUM="ERC20_ETHEREUM",a.ERC20_POLYGON="ERC20_POLYGON"}(e||(e={}))}}]);
//# sourceMappingURL=812.7256e9d2.chunk.js.map