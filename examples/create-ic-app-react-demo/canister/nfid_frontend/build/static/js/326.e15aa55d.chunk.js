"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[326],{77326:(e,t,a)=>{a.r(t),a.d(t,{default:()=>T});var s=a(87273),i=a(95163),l=a(69491),n=a(58688),r=a(55081),c=a(18414),o=a(4321),d=a(82898),m=a(6028),u=a(3752),p=a(55137),h=a(62055),x=a(47200),v=a(72565);const f=a.p+"static/media/transfer.aa5aafda7bf79e8e9214195fa4a83b20.svg";const y=a.p+"static/media/wallet.2257d98e066cc3b2ae3269b59e662065.svg";var b=a(33693);const g=e=>{switch(e.format){case"img":default:return(0,b.jsx)("div",{style:{backgroundImage:`url(${e.url})`},className:"relative z-20 h-full bg-center bg-no-repeat bg-contain"});case"iframe":return(0,b.jsx)("iframe",{title:"nft",frameBorder:"0",src:e.url,style:{zIndex:"20",border:"none",height:"100%",width:"100%",display:"block"}});case"video":return(0,b.jsx)("video",{src:e.url,autoPlay:!0,controls:!0,muted:!0})}},j=e=>{var t,a;let{nft:i,isTransactionsFetching:l=!1,transactions:j,applications:N}=e;const k=(0,s.useContext)(u.J),[,w]=(0,r.L)(k.transferService),I=(0,s.useCallback)((e=>{e.preventDefault(),w({type:"ASSIGN_SELECTED_NFT",data:i}),w({type:"CHANGE_TOKEN_TYPE",data:"nft"}),w({type:"CHANGE_DIRECTION",data:"send"}),w("SHOW")}),[i,w]);return(0,b.jsxs)(v.Z,{showBackButton:!0,headerMenu:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)(d.Ee,{className:"transition-opacity cursor-pointer hover:opacity-50",src:f,alt:"transfer",onClick:I}),(0,b.jsx)(p.C,{value:"Internet Computer"===i.blockchain?(0,m.p4)(i.collection.id,Number(i.index)):i.assetFullsize.url})]}),className:"w-full z-[1]",children:[(0,b.jsxs)("div",{className:(0,c.Z)("grid gap-[30px] max-w-[100vw]","grid-cols-1 sm:grid-cols-[auto,1fr]"),children:[(0,b.jsxs)("div",{className:"relative overflow-hidden bg-gray-50 rounded-xl h-full md:h-[342px] aspect-square",children:[(0,b.jsx)("div",{style:{backgroundImage:`url(${i.assetPreview})`},className:(0,c.Z)("bg-cover bg-center bg-no-repeat blur-md brightness-150","h-full absolute z-10 w-full opacity-70",("video"===i.assetFullsize.format||"iframe"===i.assetFullsize.format)&&"hidden")}),(0,b.jsx)(g,{url:i.assetFullsize.url,format:i.assetFullsize.format})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-blue",id:(0,o.S)("nft_collection_",i.collection.name),children:i.collection.name}),(0,b.jsx)("p",{className:"text-[28px] mt-2.5",id:(0,o.S)("nft_token_",i.name),children:i.name}),"account"in i?(0,b.jsxs)("div",{className:"flex items-center mt-4 space-x-2",children:[(0,b.jsx)(d.Ee,{src:y,alt:"wallet"}),(0,b.jsxs)("p",{className:"text-sm font-semibold text-secondary",id:`nft_wallet_${null===(t=N.find((e=>e.domain===i.account.domain)))||void 0===t?void 0:t.name.replace(/\s/g,"")}`,children:[null===(a=N.find((e=>e.domain===i.account.domain)))||void 0===a?void 0:a.name," ","account ",Number(i.account.accountId)+1]})]}):null,(0,b.jsx)(x.Z,{title:"Details",className:"mt-6",children:(0,b.jsx)("div",{className:"mt-5 space-y-4 text-sm",children:(0,b.jsxs)("div",{className:(0,c.Z)("grid grid-cols-1 sm:grid-cols-[100px,1fr] gap-5"),children:[(0,b.jsx)("p",{className:"mb-1 text-secondary",children:"Blockchain"}),(0,b.jsx)("p",{className:(0,c.Z)("w-full"),id:"nft_blockchain_",children:i.blockchain}),(0,b.jsx)("p",{className:"mb-1 text-secondary",children:"Standard"}),(0,b.jsx)("p",{id:"token-standard",className:(0,c.Z)("w-full"),children:"legacy"===i.collection.standard?"Legacy EXT":i.collection.standard}),(0,b.jsx)("p",{className:"mb-1 text-secondary",children:"NFT ID"}),(0,b.jsx)("p",{id:`nft_id_${i.tokenId.replace(/\s/g,"")}`,className:"w-full overflow-hidden",children:i.tokenId}),(0,b.jsx)("p",{className:"mb-1 text-secondary",children:"Collection ID"}),(0,b.jsx)("p",{id:"collection-id",className:"w-full overflow-hidden",children:i.contractId})]})})})]})]}),(0,b.jsx)("div",{className:(0,c.Z)("mt-[30px] max-w-[100vw]"),children:(0,b.jsx)(x.Z,{title:"About",children:(0,b.jsx)("p",{id:"token-about",className:"text-sm",children:i.collection.description})})}),(0,b.jsxs)("div",{className:(0,c.Z)("w-full","border border-gray-200 rounded-xl","my-[30px]",!j.length&&!l&&"hidden"),children:[(0,b.jsx)("div",{className:(0,c.Z)("ml-5 sm:ml-[30px]","mt-4 sm:mt-[26px]","mb-3 text-xl"),children:"Activity"}),(0,b.jsx)(h.ZP,{headings:["Event type","Date and time","From","To","Price"],rows:j.map((e=>({key:`${e.from}${e.to}${e.datetime}${e.type}`,val:Object.values(e).map(((e,t)=>(0,b.jsx)("span",{className:(0,c.Z)("text-sm",0===t&&"capitalize",(1===t||4===t)&&"whitespace-nowrap",(2===t||3===t)&&"w-[286px] break-words inline-block"),children:e})))})))}),(0,b.jsx)("div",{className:"flex justify-center w-full h-16 py-2",children:(0,b.jsx)(n.a,{fullscreen:!1,isLoading:l})})]})]})};var N=a(3209),k=a(78765);a(54915);var w=a(13791),I=a(57414);async function C(e,t,a,s){let i=await Promise.all(Array.from(Array(s).keys()).slice(a,s).map((async a=>{let s=await async function(e,t){return I.CapRouter.init({}).then((t=>t.get_token_contract_root_bucket({tokenId:w.Principal.fromText(e)}))).then((t=>{if("undefined"===typeof t.canister[0])throw Error(`Psychedelic error. No root bucket for ${e}`);return t.canister[0].toText()})).then((e=>I.CapRoot.init({host:"https://ic0.app",canisterId:e}))).then((e=>e.get_transactions({page:t}))).then((e=>e.data.map((e=>(0,I.prettifyCapTransactions)(e)))))}(e,a);return{txHistory:s.filter((e=>e.details.token===t)),isLastPage:0===s.length}})));return i.reduce(((e,t)=>({txHistory:e.txHistory.concat(t.txHistory),isLastPage:e.isLastPage||t.isLastPage})))}const Z=e=>{const[t,a]=(0,s.useState)([]),[i,l]=(0,s.useState)(!0),n=s.useCallback((async s=>{if(null===e||void 0===e||!e.contractId||null===e||void 0===e||!e.tokenId)return;let i;try{i=await C(null===e||void 0===e?void 0:e.contractId,null===e||void 0===e?void 0:e.tokenId,10*s-10,10*s),console.debug(`fetchTokenHistory_${s}`,{result:i,NFTActivity:t})}catch(c){console.error("fetchTokenHistory",c)}if(!i)return void l(!1);const r=(e=>e.map((e=>{const t=e.details;return{type:e.operation,datetime:(0,N.Z)(new Date(Number(e.time)),"MMM dd, yyyy - hh:mm:ss aaa"),from:e.from||"",to:e.to||"",price:null!==t&&void 0!==t&&t.price&&null!==t&&void 0!==t&&t.price_currency&&null!==t&&void 0!==t&&t.price_decimals?`${Number(t.price)/10**Number(t.price_decimals)} ${t.price_currency}`:""}})))(i.txHistory);r.length&&a(t.concat(r)),!i.isLastPage&&t.length<5?n(s+1):l(!1)}),[t,null===e||void 0===e?void 0:e.contractId,null===e||void 0===e?void 0:e.tokenId]),r=s.useCallback((async()=>{if(null===e||void 0===e||!e.contractId||null===e||void 0===e||!e.tokenId)return;const t=await(async(e,t,a)=>await k.q_.getActivitiesByItem({contract:e,tokenId:t,size:a}))(e.contractId,e.tokenId,5);a(t.activities.map((e=>({type:e.type,datetime:(0,N.Z)(new Date(e.date),"MMM dd, yyyy - hh:mm:ss aaa"),from:e.from,to:e.to,price:e.price?`${e.price} ETH`:""})))),l(!1)}),[null===e||void 0===e?void 0:e.contractId,null===e||void 0===e?void 0:e.tokenId]),c=s.useCallback((async()=>{if(null===e||void 0===e||!e.contractId||null===e||void 0===e||!e.tokenId)return;const t=await(async(e,t,a)=>await k.It.getActivitiesByItem({contract:e,tokenId:t,size:a}))(e.contractId,e.tokenId,5);a(t.activities.map((e=>({type:e.type,datetime:(0,N.Z)(new Date(e.date),"MMM dd, yyyy - hh:mm:ss aaa"),from:e.from,to:e.to,price:e.price?`${e.price} MATIC`:""})))),l(!1)}),[null===e||void 0===e?void 0:e.contractId,null===e||void 0===e?void 0:e.tokenId]);s.useEffect((()=>{t.length||("Internet Computer"===(null===e||void 0===e?void 0:e.blockchain)&&n(1),"Ethereum"===(null===e||void 0===e?void 0:e.blockchain)&&r(),"Polygon"===(null===e||void 0===e?void 0:e.blockchain)&&c())}),[t.length,n,r,c,null===e||void 0===e?void 0:e.blockchain]);const o=s.useMemo((()=>t.sort(((e,t)=>Number(t.datetime)-Number(e.datetime)))),[t]);return console.log({transactions:o,NFTActivity:t,nft:e}),{transactions:o,isActivityFetching:i}},T=()=>{const e=(0,i.TH)().state,t=(0,l.pq)(),a=s.useMemo((()=>null===e||void 0===e?void 0:e.nft),[null===e||void 0===e?void 0:e.nft]),{transactions:r,isActivityFetching:c}=Z(a);return a?(0,b.jsx)(j,{nft:a,isTransactionsFetching:c,transactions:r,applications:t.applicationsMeta||[]}):(0,b.jsx)(v.Z,{pageTitle:"Fetching NFT...",children:(0,b.jsx)(n.a,{isLoading:!0})})}},55137:(e,t,a)=>{a.d(t,{C:()=>o});var s=a(18414),i=a(87273),l=a(82898);const n=a.p+"static/media/copied.7db236d4ed9a8d82463d41f442395067.svg";const r=a.p+"static/media/copy.fa74bb78f3023163889b69dafbaee228.svg";var c=a(33693);const o=e=>{let{value:t,className:a}=e;const[o,d]=i.useState(!1),m=i.useCallback((()=>{d(!0),navigator.clipboard.writeText(t),setTimeout((()=>{d(!1)}),2e3)}),[t]);return(0,c.jsx)("div",{className:(0,s.Z)(!o&&"hover:opacity-50 cursor-pointer transition-opacity",a),children:(0,c.jsx)(l.u,{tip:"Copy",children:(0,c.jsx)(l.Ee,{className:"w-full",onClick:m,src:o?n:r,alt:"copy"})})})}},62055:(e,t,a)=>{a.d(t,{W8:()=>r,ZP:()=>d,ss:()=>c,y6:()=>n});var s=a(18414),i=(a(87273),a(17719)),l=a(33693);const n=e=>{let{children:t}=e;return(0,l.jsx)("div",{className:(0,s.Z)("overflow-x-scroll"),children:t})},r=e=>{let{children:t,className:a}=e;return(0,l.jsx)("table",{className:(0,s.Z)("w-full text-left min-w-[640px]",null!==a&&void 0!==a?a:"table-auto"),children:t})},c=e=>{let{sort:t,reverse:a,headings:n,handleHeaderClick:r}=e;return(0,l.jsx)("thead",{className:"contents",children:(0,l.jsx)("tr",{className:(0,s.Z)("border-b border-gray-900"),children:n.map(((e,n)=>(0,l.jsx)("th",{className:(0,s.Z)("h-16 px-3",0===n&&"pl-[30px]",n===e.length-1&&"pr-[30px]",(null===t||void 0===t?void 0:t.includes(e))&&"cursor-pointer hover:bg-gray-100"),onClick:()=>r&&r(e),children:(0,l.jsxs)("div",{className:(0,s.Z)("flex h-full gap-2 items-center group whitespace-nowrap"),children:[e,(null===t||void 0===t?void 0:t[0])===e&&(0,l.jsx)(i.CSs,{className:(0,s.Z)(a&&"rotate-180")}),(null===t||void 0===t?void 0:t.includes(e))&&(null===t||void 0===t?void 0:t[0])!==e&&(0,l.jsx)("div",{className:(0,s.Z)("invisible group-hover:visible"),children:(0,l.jsx)(i.CSs,{})})]})},`heading${e}`)))})})},o=e=>{let{rows:t,headings:a}=e;return(0,l.jsx)("tbody",{children:t.map(((e,t)=>(0,l.jsx)("tr",{className:(0,s.Z)("border-b border-grey-200"),children:e.val.map(((t,i)=>(0,l.jsx)("td",{className:(0,s.Z)("h-[85px] px-3",0===i&&"pl-[30px]",i===e.val.length-1&&"pr-[30px]"),children:t},`row${e.key}cell${a[i]}`)))},`row${e.key}`)))})};function d(e){let{headings:t,rows:a,sort:s,reverse:i,handleHeaderClick:d}=e;return(0,l.jsx)(n,{children:(0,l.jsxs)(r,{children:[(0,l.jsx)(c,{headings:t,sort:s,reverse:i,handleHeaderClick:d}),(0,l.jsx)(o,{rows:a,headings:t})]})})}},4321:(e,t,a)=>{function s(e,t){return e+t.replace(/\s|#/g,"")}a.d(t,{S:()=>s})},47200:(e,t,a)=>{a.d(t,{Z:()=>l});var s=a(18414),i=(a(87273),a(33693));const l=e=>{let{title:t,subTitle:a,children:l,className:n,showChildrenPadding:r=!0,id:c}=e;return(0,i.jsxs)("div",{id:c,className:(0,s.Z)("block border border-gray-200 rounded-xl","py-4 sm:py-[26px]",n),children:[(0,i.jsxs)("div",{className:"px-5",children:[t&&(0,i.jsx)("div",{className:"flex items-center justify-between mb-3 text-xl",children:t}),a&&(0,i.jsx)("div",{className:"flex items-center justify-between mb-4 text-sm leading-5 text-secondary",children:a})]}),(0,i.jsx)("div",{className:(0,s.Z)(r&&"px-5 sm:px-[30px]"),children:l})]})}}}]);
//# sourceMappingURL=326.e15aa55d.chunk.js.map