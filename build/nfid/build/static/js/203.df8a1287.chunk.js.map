{"version":3,"file":"static/js/203.df8a1287.chunk.js","mappings":"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","sources":["ui/pages/recover-nfid/index.tsx","../../../packages/utils/src/lib/seed-phrase.ts","apps/authentication/recover-nfid/index.tsx"],"sourcesContent":["import clsx from \"clsx\"\nimport React from \"react\"\nimport { FieldValues, useForm } from \"react-hook-form\"\n\nimport { TextArea } from \"@nfid-frontend/ui\"\nimport { formatSeedPhrase } from \"@nfid-frontend/utils\"\n\nimport { Button } from \"frontend/ui/atoms/button\"\nimport { CONTAINER_CLASSES } from \"frontend/ui/atoms/container\"\nimport { Loader } from \"frontend/ui/atoms/loader\"\nimport { H2 } from \"frontend/ui/atoms/typography\"\nimport { AppScreen } from \"frontend/ui/templates/app-screen/AppScreen\"\n\ninterface RecoverNFIDProps extends React.HTMLAttributes<HTMLDivElement> {\n  onRecover: (data: FieldValues) => {}\n  toggle: () => void\n  isVerifiedDomain?: boolean\n  isLoading: boolean\n  responseError?: any\n}\n\nexport const RecoverNFID: React.FC<RecoverNFIDProps> = ({\n  className,\n  toggle,\n  isVerifiedDomain,\n  onRecover,\n  isLoading,\n  responseError,\n}) => {\n  const {\n    register,\n    formState: { errors },\n    setError,\n    handleSubmit,\n  } = useForm<{ recoveryPhrase: string }>({\n    mode: \"all\",\n  })\n\n  React.useEffect(() => {\n    if (responseError) {\n      setError(\"recoveryPhrase\", {\n        type: \"manual\",\n        message: responseError,\n      })\n    }\n  }, [responseError, setError])\n\n  const handleRecoveryPhraseChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    event.target.value = formatSeedPhrase(event.target.value)\n  }\n\n  return (\n    <AppScreen isFocused showLogo>\n      <main className={clsx(\"flex flex-1\")}>\n        <div className={clsx(CONTAINER_CLASSES)}>\n          <div className=\"grid h-full grid-cols-12\">\n            <div className=\"flex flex-col col-span-12 md:col-span-11 lg:col-span-7\">\n              <div className={clsx(\"\", className)}>\n                <div>\n                  <H2 className=\"mb-4\">Recover NFID</H2>\n\n                  <div className={clsx(\"mb-6\")}>\n                    Paste your recovery phrase here to proceed:\n                  </div>\n\n                  <TextArea\n                    rows={6}\n                    errorText={errors?.recoveryPhrase?.message}\n                    {...register(\"recoveryPhrase\", {\n                      required: {\n                        value: true,\n                        message: \"Please enter your Recovery Phrase\",\n                      },\n                      onChange: handleRecoveryPhraseChange,\n                    })}\n                  />\n                  <div>\n                    <input\n                      type=\"checkbox\"\n                      id=\"has-verified-domain\"\n                      className=\"rounded\"\n                      onChange={toggle}\n                      checked={isVerifiedDomain}\n                    />\n                    <label htmlFor=\"has-verified-domain\" className=\"ml-2\">\n                      I got to this screen by first going to https://nfid.one,\n                      being redirected to this landing page, and following the\n                      link to recover my NFID.\n                    </label>\n                  </div>\n\n                  <Button\n                    primary\n                    large\n                    className=\"my-4\"\n                    id=\"recovery-button\"\n                    onClick={handleSubmit(onRecover)}\n                    disabled={!isVerifiedDomain}\n                  >\n                    Recover\n                  </Button>\n\n                  <Loader isLoading={isLoading} />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n    </AppScreen>\n  )\n}\n","export const formatSeedPhrase = (string: string) => {\n  // Replace newline characters with space\n  let replacedString = string.replace(/\\r?\\n|\\r/g, \" \")\n\n  // Replace non-alphanumeric characters except spaces with an empty string\n  replacedString = replacedString.replace(/[^a-zA-Z0-9 ]/g, \"\")\n\n  return replacedString\n}\n","import * as Sentry from \"@sentry/browser\"\nimport React, { useState } from \"react\"\nimport { FieldValues } from \"react-hook-form\"\n\nimport { useAccount } from \"frontend/integration/identity-manager/account/hooks\"\nimport { parseUserNumber } from \"frontend/integration/internet-identity/userNumber\"\nimport { RecoverNFID } from \"frontend/ui/pages/recover-nfid\"\nimport { useNFIDNavigate } from \"frontend/ui/utils/use-nfid-navigate\"\n\nimport { useAuthentication } from \"../use-authentication\"\n\ninterface RestoreAccessPointRecoveryPhraseProps {\n  registerDeviceDeciderPath: string\n  isVerifiedDomainDefault?: boolean\n}\n\nexport const AppScreenRecoverNFID: React.FC<\n  RestoreAccessPointRecoveryPhraseProps\n> = ({ registerDeviceDeciderPath, isVerifiedDomainDefault }) => {\n  const [responseError, setResponseError] = useState<any>(null)\n  const [isVerifiedDomain, toggleIsVerifiedDomain] = React.useReducer(\n    (state) => !state,\n    !!isVerifiedDomainDefault,\n  )\n  const { refreshProfile } = useAccount()\n\n  const { navigate } = useNFIDNavigate()\n  const { loginWithRecovery, isLoading } = useAuthentication()\n\n  const onRecover = React.useCallback(\n    async (data: FieldValues) => {\n      const recoveryPhrase = data.recoveryPhrase.replace(/\\s+/g, \" \").trim()\n\n      const stringUserNumber = recoveryPhrase.split(\" \")[0]\n      const userNumber = parseUserNumber(stringUserNumber)\n      const seedPhrase = recoveryPhrase.split(`${userNumber} `)[1]\n\n      if (!userNumber) {\n        return setResponseError(\"Invalid Recovery Phrase (missing Anchor)\")\n      }\n      let result = null\n\n      try {\n        setResponseError(\"\")\n        result = await loginWithRecovery(seedPhrase, userNumber)\n        await refreshProfile()\n      } catch (e: any) {\n        console.error(e)\n        return setResponseError(\n          e?.message?.length ??\n            \"We cannot restore your NFID with this recovery phrase. Please check it and try again.\",\n        )\n      }\n\n      if (result?.tag !== \"ok\") {\n        return setResponseError(\n          \"We cannot restore your NFID with this recovery phrase. Please check it and try again.\",\n        )\n      }\n\n      Sentry.setUser({ id: userNumber.toString() })\n      navigate(registerDeviceDeciderPath, { state: { userNumber } })\n    },\n    [loginWithRecovery, navigate, refreshProfile, registerDeviceDeciderPath],\n  )\n\n  return (\n    <RecoverNFID\n      onRecover={onRecover}\n      toggle={toggleIsVerifiedDomain}\n      isVerifiedDomain={isVerifiedDomain}\n      responseError={responseError}\n      isLoading={isLoading}\n    />\n  )\n}\n\nexport default AppScreenRecoverNFID\n"],"names":["RecoverNFID","className","toggle","isVerifiedDomain","onRecover","isLoading","responseError","register","formState","errors","setError","handleSubmit","useForm","mode","React","type","message","AppScreen","isFocused","showLogo","clsx","CONTAINER_CLASSES","H2","rows","errorText","recoveryPhrase","required","value","onChange","event","target","string","replacedString","replace","formatSeedPhrase","id","checked","htmlFor","primary","large","onClick","disabled","AppScreenRecoverNFID","registerDeviceDeciderPath","isVerifiedDomainDefault","setResponseError","useState","toggleIsVerifiedDomain","state","refreshProfile","useAccount","navigate","useNFIDNavigate","loginWithRecovery","useAuthentication","async","data","trim","stringUserNumber","split","userNumber","parseUserNumber","seedPhrase","result","e","console","error","length","tag","Sentry","toString"],"sourceRoot":""}